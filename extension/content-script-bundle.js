var rse=(()=>{var f=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var C=(t,e)=>{for(var r in e)f(t,r,{get:e[r],enumerable:!0})},S=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of h(e))!y.call(t,s)&&s!==r&&f(t,s,{get:()=>e[s],enumerable:!(n=w(e,s))||n.enumerable});return t};var b=t=>S(f({},"__esModule",{value:!0}),t);var i=(t,e,r)=>new Promise((n,s)=>{var c=o=>{try{u(r.next(o))}catch(d){s(d)}},l=o=>{try{u(r.throw(o))}catch(d){s(d)}},u=o=>o.done?n(o.value):Promise.resolve(o.value).then(c,l);u((r=r.apply(t,e)).next())});var O={};C(O,{CrateDocManager:()=>I,IndexSetter:()=>m,settings:()=>x,storage:()=>a});var g=class t{static browserType(){let e=navigator.userAgent.toLowerCase();return e.indexOf("edg")!==-1?"edge":e.indexOf("chrome")!==-1?"chrome":e.indexOf("safari")!==-1?"safari":e.indexOf("gecko")!==-1?"firefox":"unknown"}static isRunningInWebExtension(){return typeof chrome=="object"&&chrome.runtime}static omniboxPageSize(){return{firefox:6,edge:7,chrome:8,unknown:6}[t.browserType()]}static escape(e){return e=e||"",t.browserType()==="firefox"?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'"):t.escapeAmpersand(e).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}static escapeAmpersand(e){return e.replace(" & "," &amp; ")}static normalizeDate(e){let r=""+(e.getMonth()+1),n=""+e.getDate();return[e.getFullYear(),r.padStart(2,"0"),n.padStart(2,"0")].join("-")}static capitalize(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}static eliminateTags(e){return e?e.replace(/<\/?(match|dim|code|em|strong|span)>/g,""):""}};var p=null;g.isRunningInWebExtension()?p={getAllItems:()=>new Promise(t=>{chrome.storage.local.get(null,t)}),getItem:t=>new Promise(e=>{chrome.storage.local.get(t,r=>{e(r?r[t]:null)})}),setItem:(t,e)=>new Promise(r=>{chrome.storage.local.set({[t]:e},r)}),removeItem:t=>new Promise(e=>{chrome.storage.local.remove(t,e)})}:p={getAllItems:()=>new Promise(t=>{}),getItem:t=>new Promise(e=>{let r=localStorage.getItem(t);if(r)try{r=JSON.parse(r)}catch(n){}e(r)}),setItem:(t,e)=>new Promise(r=>{e instanceof Object&&(e=JSON.stringify(e)),localStorage.setItem(t,e),r()}),removeItem:t=>new Promise(e=>{localStorage.removeItem(t),e()})};var a=p;var P={get autoUpdate(){return i(this,null,function*(){return(yield a.getItem("auto-update"))||!1})},set autoUpdate(t){a.setItem("auto-update",t)},get isOfflineMode(){return i(this,null,function*(){return(yield a.getItem("offline-mode"))||!1})},set isOfflineMode(t){a.setItem("offline-mode",t)},get offlineDocPath(){return i(this,null,function*(){return(yield a.getItem("offline-path"))||""})},set offlineDocPath(t){a.setItem("offline-path",t)},get crateRegistry(){return i(this,null,function*(){return(yield a.getItem("crate-registry"))||"crates.io"})},set crateRegistry(t){a.setItem("crate-registry",t)},get defaultSearch(){return i(this,null,function*(){return(yield a.getItem("default-search"))||{thirdPartyDocs:!1,docsRs:!0,attributes:!0}})},set defaultSearch(t){a.setItem("default-search",t)},get showMacroRailroad(){return i(this,null,function*(){let t=yield a.getItem("show-macro-railroad");return t===void 0?!0:t})},set showMacroRailroad(t){a.setItem("show-macro-railroad",t)},get keepCratesUpToDate(){return i(this,null,function*(){let t=yield a.getItem("keep-crates-up-to-date");return t===void 0?!1:t})},set keepCratesUpToDate(t){a.setItem("keep-crates-up-to-date",t)}},x=P;var m=class t{static setStdStableIndex(e){a.setItem("index-std-stable",e)}static setStdNightlyIndex(e){a.setItem("index-std-nightly",e)}static setDescShards(e,r){r&&a.setItem(`desc-shards-${e}`,r)}static setBookIndex(e){a.setItem("index-book",e)}static setLabelIndex(e){a.setItem("index-label",e)}static setRfcIndex(e){a.setItem("index-rfc",e)}static setCrateMapping(e){a.setItem("index-crate-mapping",e)}static setCrateIndex(e){a.setItem("index-crate",e)}static setLintIndex(e){a.setItem("index-lint",e)}static setCaniuseIndex(e){a.setItem("index-caniuse",e)}static setRustcIndex(e){a.setItem("index-rustc",e)}static setTargetIndex(e){a.setItem("index-target",e)}static setCommandIndex(e){a.setItem("index-command",e)}static updateAllIndex(){t.setBookIndex(booksIndex),t.setCaniuseIndex(caniuseIndex),t.setCommandIndex(commandsIndex),t.setCrateIndex(crateIndex),t.setCrateMapping(mapping),t.setLabelIndex(labelsIndex),t.setLintIndex(lintsIndex),t.setRfcIndex(rfcsIndex),t.setRustcIndex(rustcIndex),t.setStdStableIndex(searchIndex),t.setTargetIndex(targetsIndex)}};var I=class t{static getCrates(){return i(this,null,function*(){return(yield a.getItem("crates"))||{}})}static getCrateByName(e){return i(this,null,function*(){let r=yield t.getCrates();if(r[e])return r[e];{let n=Object.entries(r).find(([s,{crateName:c}])=>c==e);return n?n[1]:null}})}static getCrateSearchIndex(e){return i(this,null,function*(){let r=yield a.getItem(`@${e}`);if(r)return new Map(r);{let n=yield t.getCrates(),s=Object.entries(n).find(([c,{crateName:l}])=>l==e);if(s){let c=s[0];return new Map(yield a.getItem(`@${c}`))}else return null}})}static addCrate(u){return i(this,arguments,function*({libName:e,crateVersion:r,crateTitle:n,searchIndex:s,crateName:c,descShards:l}){yield a.setItem(`@${e}`,s);let o=n,d=yield t.getCrates();e in d?d[e]={version:r,doc:o,time:d[e].time,crateName:c}:d[e]={version:r,doc:o,time:Date.now(),crateName:c},yield a.setItem("crates",d),m.setDescShards(e,l)})}static removeCrate(e){return i(this,null,function*(){let r=yield t.getCrates();delete r[e],yield a.setItem("crates",r),yield a.removeItem(`@${e}`),yield a.removeItem(`desc-shards-${e}`)})}};return b(O);})();
